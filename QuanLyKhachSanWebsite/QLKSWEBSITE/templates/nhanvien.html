{% extends "Layout/base.html" %}
{%block content%}
{% if current_user.is_authenticated and current_user.idLoaiTaiKhoan == 3 %}
<div class="container mt-4">
    <!-- Tab navigation -->
    <ul class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link {% if id == 'tatca' or id == None %}active{% endif %}" href="/nhanvien?id=tatca">Tất cả</a>
        </li>
        {% for loai in loaiPhong %}
        <li class="nav-item">
            <a class="nav-link {% if id|int == loai.id %}active{% endif %}" href="/nhanvien?id={{loai.id}}">{{loai.tenLoaiPhong}}</a>
        </li>
        {% endfor %}
    </ul>

    <!-- Room cards -->
    {% if id == "tatca" or id == None%}
    <div class="row mt-4 containerNV">
        {% for p, phieu in phongDangSuDung %}
        <!-- Room 1 -->
        <div class="col-md-3 mb-4 asimaruoi">
            <div class="room-card bg-warning">
                <div class="room-header">
                    <i class="bi bi-people-fill"></i>
                    <i class="bi bi-calendar-event"></i>
                </div>
                <h5 class="mt-3">Phòng {{p.id}}</h5>
                <p>
                    <label>Ngày nhận phòng:</label>
                    <i class="bi bi-calendar-check"></i> {{phieu.ngayNhanPhong}}<br>
                    <label>Ngày trả phòng:</label>
                    <i class="bi bi-calendar-check"></i> {{phieu.ngayTraPhong}}<br>
                </p>
                <h5 class="mt-3">Trạng thái: Đang sử dụng</h5>
                <form style="justify-content: center">
                    <input type="hidden" name="idPhieuThuePhong" value="{{phieu.id}}">
                    <button type="submit">Trả phòng</button>
                </form>
            </div>
        </div>
        <!-- Add more cards here -->
        {% endfor %}
        {% for p, phieu in phongDangSuDung %}
        {% for ph in phong %}
        {% if  ph.id|int != p.id|int %}
        <div class="col-md-3 mb-4 asimaruoi">
            <div class="room-card bg-primary"> <!-- Đổi bg-warning thành bg-primary -->
                <div class="room-header">
                    <i class="bi bi-people-fill"></i>
                    <i class="bi bi-calendar-event"></i>
                </div>
                <h5 class="mt-3">Phòng {{ph.id}}</h5>
                <h5 class="mt-3">Trạng thái: Trống</h5>
            </div>
        </div>
        {% endif %}
        {% endfor %}
        {% endfor %}
    </div>
    {% else %}
    <div class="row mt-4 containerNV">
        {% for p, phieu in phongDangSuDung %}
        {% if p.idLoaiPhong == id|int %}
        <!-- Room 1 -->
        <div class="col-md-3 mb-4 asimaruoi">
            <div class="room-card bg-warning">
                <div class="room-header">
                    <i class="bi bi-people-fill"></i>
                    <i class="bi bi-calendar-event"></i>
                </div>
                <h5 class="mt-3">Phòng {{p.id}}</h5>
                <p>
                    <label>Ngày nhận phòng:</label>
                    <i class="bi bi-calendar-check"></i> {{phieu.ngayNhanPhong}}<br>
                    <label>Ngày trả phòng:</label>
                    <i class="bi bi-calendar-check"></i> {{phieu.ngayTraPhong}}<br>
                </p>
                <h5 class="mt-3">Trạng thái: Đang sử dụng</h5>
                <form>
                    <input type="hidden" name="idPhieuThuePhong" value="{{phieu.id}}">
                    <button type="submit">Trả phòng</button>
                </form>
            </div>
        </div>
        <!-- Add more cards here -->
        {% endif %}
        {% endfor %}
        {% for p, phieu in phongDangSuDung %}
        {% for phh in phong %}
        {% if phh.id|int != p.id|int and phh.idLoaiPhong == id|int %}
        <div class="col-md-3 mb-4 asimaruoi">
            <div class="room-card bg-primary"> <!-- Đổi bg-warning thành bg-primary -->
                <div class="room-header">
                    <i class="bi bi-people-fill"></i>
                    <i class="bi bi-calendar-event"></i>
                </div>
                <h5 class="mt-3">Phòng {{phh.id}}</h5>
                <h5 class="mt-3">Trạng thái: Trống</h5>
            </div>
        </div>
        {% endif %}
        {% endfor %}
        {% endfor %}
    </div>
    {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
{% else %}
<div class="container_sign">
    <div class="form-container">
        <form method="post" action="nhanvien-login">
            <h2 class="text-center">Đăng Nhập</h2>
            <div class="form-group">
                <label for="username">Tên đăng nhập</label>
                <input type="text" class="form-control" id="username" name="username" required />
            </div>
            <div class="form-group">
                <label for="pass">Mật khẩu</label>
                <input type="password" class="form-control" id="pass" name="password" />
            </div>
                <input type="submit" value="Đăng nhập" class="btn btn-danger" />
        </form>
    </div>
</div>
{% endif %}
{% endblock %}
